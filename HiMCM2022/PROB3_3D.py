'''
This is the code that visualize the 3D plane of the location of the expected hive and plant locations.
Used in: HiMCM Problem 3
'''

from mpl_toolkits.mplot3d import Axes3D
from mpl_toolkits.mplot3d import axes3d
import matplotlib.pyplot as plt
import numpy as np

x = np.array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27])
y = np.array([27,26,25,24,23,22,21,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1,0])
X, Y = np.meshgrid(x, y)

Z = np.array([[10, 15, 21, 30, 45, 35, 29, 27, 26, 24, 23, 21, 19, 15, 14, 13, 11, 10, 9, 8, 6, 4, 2, 1, 0, 0, 0, 0],
              [12, 16, 22, 34, 49, 42, 35, 32, 30, 29, 28, 27, 25, 24, 22, 21, 20, 17, 16, 14, 13, 9, 7, 6, 4, 2, 0, 0],
              [15, 18, 24, 39, 51, 47, 40, 37, 34, 31, 29, 26, 24, 22, 21, 19, 17, 16, 14, 11, 9, 8, 6, 5, 2, 0, 0, 0],
              [16, 21, 26, 41, 56, 52, 48, 42, 39, 35, 31, 29, 27, 24, 22, 21, 20, 18, 16, 14, 12, 11, 9, 8, 6, 5, 4, 2],
              [18, 25, 31, 45, 71, 55, 49, 43, 38, 33, 30, 27, 28, 26, 24, 22, 21, 18, 15, 14, 12, 12, 10, 9, 8, 7, 6, 4],
              [27, 31, 38, 51, 86, 74, 52, 44, 39, 32, 28, 24, 23, 19, 22, 20, 19, 15, 12, 14, 13, 12, 11, 9, 8, 7, 6, 5],
              [29, 34, 43, 58, 104, 87, 65, 49, 38, 29, 25, 22, 19, 15, 18, 20, 19, 18, 16, 15, 14, 13, 12, 10, 9, 8, 7, 6],
              [32, 37, 50, 72, 112, 92, 76, 56, 36, 25, 20, 18, 15, 11, 13, 19, 18, 16, 15, 12, 11, 10, 9, 7, 6, 4, 2, 1],
              [35, 40, 56, 84, 128, 103, 75, 54, 32, 21, 15, 13, 10, 6, 7, 17, 16, 14, 12, 11, 10, 8, 6, 3, 2, 1, 0, 0],
              [33, 38, 55, 76, 118, 97, 84, 77, 69, 63, 56, 48, 41, 35, 28, 21, 17, 14, 12, 10, 8, 6, 4, 2, 1, 0, 0, 0],
              [31, 37, 54, 65, 92, 74, 66, 58, 54, 47, 40, 32, 27, 22, 17, 14, 10, 9, 8, 6, 4, 2, 1, 0, 0, 0, 0, 0],
              [29, 35, 48, 52, 68, 79, 52, 45, 39, 36, 34, 32, 26, 23, 18, 13, 11, 10, 7, 6, 2, 1, 0, 0, 0, 0, 0, 0],
              [27, 33, 44, 50, 55, 70, 54, 50, 46, 42, 35, 32, 27, 24, 16, 15, 12, 11, 7, 5, 3, 2, 0, 0, 0, 0, 0, 0],
              [26, 30, 41, 45, 48, 52, 47, 42, 41, 39, 37, 34, 31, 27, 20, 16, 14, 12, 10, 7, 4, 2, 1, 0, 0, 0, 0, 0],
              [25, 24, 22, 21, 19, 17, 16, 15, 14, 12, 11, 10, 8, 6, 5, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [27, 28, 32, 30, 28, 26, 24, 22, 18, 16, 14, 10, 8, 7, 6, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [30, 33, 37, 41, 40, 37, 33, 29, 26, 23, 20, 17, 14, 12, 9, 7, 6, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0],
              [35, 39, 48, 45, 41, 38, 35, 32, 29, 28, 25, 21, 17, 14, 10, 8, 5, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [29, 35, 42, 44, 41, 37, 34, 32, 30, 27, 24, 20, 16, 13, 11, 7, 6, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [24, 29, 35, 34, 33, 32, 31, 30, 29, 28, 26, 24, 20, 16, 12, 8, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [20, 25, 31, 29, 28, 27, 26, 24, 22, 20, 19, 17, 16, 14, 12, 10, 8, 4, 3, 1, 0, 0, 0, 0, 0, 0, 0, 0],
              [17, 20, 25, 24, 22, 20, 19, 16, 14, 12, 10, 8, 5, 3, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [15, 17, 16, 14, 13, 12, 11, 11, 9, 8, 7, 5, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [14, 15, 13, 12, 11, 9, 8, 7, 5, 4, 3, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [13, 13, 14, 13, 12, 11, 10, 8, 7, 5, 4, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [12, 12, 12, 11, 10, 9, 7, 6, 6, 5, 4, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [12, 12, 11, 10, 8, 6, 7, 5, 5, 4, 3, 2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
              [11, 11, 10, 9, 9, 7, 6, 5, 5, 5, 3, 2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]])

fig = plt.figure(figsize=(28,28), dpi=300)
ax = fig.gca(projection='3d')


# Flower = [[0, 12], [1, 6], [7, 26], [10, 17], [4, 25], [20, 20], [23, 23], [24, 9]]
# Hive = [[ 5, 13], [1, 6], [ 7, 26], [13, 18], [ 7 ,23], [21, 16], [21, 16], [21, 12]]
Flower = [[1, 17], [1, 1], [13, 7], [0, 10],[15, 21],[8, 18],[17, 23],[4, 14],[27, 25],[13, 11],[4, 15],[10, 25],[18, 13],[16, 9],[24, 1],[17, 16],[16, 11],[12, 0],[9, 14],[15, 13],[24, 21],[20, 19],[7, 12],[13, 20],[7, 7],[10, 7],[21, 1],[19, 9],[4, 17],[0, 26],[16, 5],[8, 2],[23, 7],[24, 18],[0, 15],[26, 3],[8, 10],[4, 26],[14, 20],[27, 14],[1, 2],[26, 15],[18, 4],[19, 13],[9, 27],[2, 10],[8, 23],[11, 25],[10, 15],[6, 21],[19, 20],[12, 10],[22, 0],[18, 13],[10, 23],[9, 10],[18, 27],[27, 25],[6, 20],[3, 19],[15, 16],[19, 18],[0, 17],[10, 0],[8, 3],[12, 15],[11, 17],[27, 3],[14, 10],[17, 12],[12, 24],[9, 18],[20, 10],[15, 0],[24, 26],[14, 15],[5, 13],[25, 17],[15, 20],[0, 1],[22, 27],[10, 3],[21, 27],[15, 21],[10, 23],[12, 12],[26, 5],[12, 22],[12, 11]]
Hive = [[ 6, 14], [1,1], [12 ,9],[ 1 ,13],[14, 19],[13 ,17],[14 ,19],[ 1, 13],[21 ,16],[12 ,10],[ 1, 14],[ 7 ,26],[17, 13],[16,  9],[24,  0],[19, 16],[16, 11],[15,  1],[12, 12],[19, 15],[21, 16],[21, 15],[ 7 ,12],[14, 15],[3, 5],[3, 5],[21,  1],[19 , 9],[ 6 ,14],[ 0, 22],[16 , 5],[3, 5],[22,10],[21 ,16],[ 7 ,14],[27  ,2],[ 7, 12],[ 6, 27],[14, 19],[21, 16],[3, 1],[21, 16],[18,  4],[19, 13],[ 7, 26],[1, 9],[ 7, 25],[14, 19],[10, 15],[ 7, 14],[21, 16],[12, 10],[22,  2],[17, 13],[14, 19],[3, 5],[14.,19],[21 ,16],[ 5 ,17],[ 5 ,17],[14, 16],[21, 16],[ 7 ,13],[5, 1],[3, 5],[12 ,14],[13, 18],[27 , 3],[15, 11],[17 ,12],[14 ,19],[13,17],[18, 11.],[15 , 1.],[21, 16],[14, 15],[ 5, 13],[21, 16],[14 ,19],[1, 1.],[21 ,16],[3, 5],[14 ,19],[14 ,19],[14, 19],[12 ,12],[27, 6],[14, 19],[12 ,11]]

surf = ax.plot_surface(X, Y, Z,
                       cmap=plt.cm.plasma,
                       linewidth=0,
                       antialiased=False)
plt.savefig('Plant and hive3D_TER.jpg', dpi=300)


xf=[]
for i in Flower:
    xf.append(i[0])
yf=[]
for j in Flower:
    yf.append(j[1])
zf=[]
print(xf)
for i in range(len(xf)):
    zf.append(Z[xf[i]][yf[i]]+10.5)
ax.scatter(xf, yf, zf, color='#54b345', label='Plant location', marker = '^', s=200)

xh=[]
yh=[]
zh=[]
for i in Hive:
    xh.append(int(i[0]))
    yh.append(int(i[1]))
for i in range(len(xh)):
    zh.append(Z[xh[i]][yh[i]]+6)
ax.scatter(xh, yh, zh, color='#bb9727', label='Hive location', marker = '.',s =100)
plt.title('Plant and hive location on a certain day', fontsize = 15)
plt.legend(loc = 'upper right', shadow = True, fancybox='blue', fontsize = 6)

ax.set_zlim(0, 130)
plt.xticks(fontsize = 20)
plt.yticks(fontsize = 20)

plt.savefig('Plant and hive3D.jpg', dpi=300)

plt.figure(figsize=(10, 10), dpi = 300)
plt.scatter(xf, yf, color='#54b345', label='Plant location', marker = '^',s=100)
plt.scatter(xh, yh, color='#bb9727', label='Hive location', marker = 'o',s=30)
plt.title('Plant and hive location on a certain day', fontsize = 35)
plt.legend(loc = 'upper right', shadow = True, fancybox='blue', fontsize = 15)
plt.xticks(fontsize = 20)
plt.yticks(fontsize = 20)
ax.set_zticks([i for i in range(0, 140, 10)], fontsize = 40)
plt.savefig('Plant and hive2D.jpg', dpi=300)
plt.show()